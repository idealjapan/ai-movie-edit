# AI動画カット＆テロップツール 要件定義書

## 1. システム概要

### 1.1 目的
社内で制作する広告動画の編集作業を効率化し、編集時間を大幅に短縮することを目的とする。特に、無音部分のカット作業とテロップ入力作業の自動化により、編集者の作業負担を軽減する。

### 1.2 背景
- 現状: 10分の動画編集に約30分〜1時間を要している
- 課題: 無音部分の手動カット、テロップの手動入力が時間を要する
- 解決策: AI技術を活用した自動化ツールの開発

### 1.3 対象ユーザー
- 主要ユーザー: 社内動画編集チーム（3-5名）
- 副次ユーザー: マーケティング部門の動画制作担当者

### 1.4 期待効果
- 編集時間を従来の1/3に短縮（10分動画を10分以内で処理）
- 編集品質の均一化
- 編集者の創造的作業への集中

## 2. 機能要件

### 2.1 コア機能

#### 2.1.1 無音検出・自動カット機能
- **機能概要**: 動画内の無音部分を自動検出し、カット編集用のデータを生成
- **詳細要件**:
  - 無音判定閾値: -20dB〜-50dB（調整可能）
  - 最小無音時間: 100ms〜5000ms（調整可能）
  - カット前後の余白: 0ms〜1000ms（調整可能）
  - 検出アルゴリズム: 振幅ベース / AI文字起こしベース（選択可能）

#### 2.1.2 AI文字起こし機能
- **機能概要**: OpenAI Whisper APIを使用した高精度な音声認識
- **詳細要件**:
  - 対応言語: 日本語（優先）、英語
  - 認識精度: 95%以上（クリアな音声の場合）
  - タイムスタンプ精度: ±100ms
  - 長時間動画対応: 最大2時間

#### 2.1.3 テロップ自動生成機能
- **機能概要**: GPT-4を使用したテロップの整形と最適化
- **詳細要件**:
  - 1行あたりの文字数: 10-20文字（調整可能）
  - 最大行数: 2-3行（調整可能）
  - 表示時間: 最小1秒〜最大10秒
  - 句読点の自動調整

#### 2.1.4 Premiere Pro XML出力機能
- **機能概要**: Premiere Pro完全互換のXMLファイル生成
- **詳細要件**:
  - XML形式: XMEML version 4
  - 対応バージョン: Premiere Pro 2022以降
  - 出力方式:
    - 複数クリップ方式（推奨）: 無音部分を除いた複数クリップ配置
    - 単一クリップ方式: マーカー付き単一クリップ配置
  - メタデータ: Premiere Pro固有プロパティの完全サポート

### 2.2 補助機能

#### 2.2.1 バッチ処理機能
- 複数動画ファイルの一括処理
- 処理キューの管理
- エラーハンドリングとリトライ機能

#### 2.2.2 プレビュー機能
- カット結果のプレビュー再生
- テロップ表示のプレビュー
- 編集ポイントの微調整

#### 2.2.3 設定管理機能
- プリセット設定の保存/読み込み
- プロジェクト別設定の管理
- デフォルト値のカスタマイズ

## 3. 非機能要件

### 3.1 パフォーマンス要件
- **処理速度**: 10分の動画を3分以内で処理完了
- **同時処理**: 最大3本の動画を並列処理可能
- **メモリ使用量**: 最大4GB以内
- **ディスク容量**: 元動画の2倍以内の一時ファイル

### 3.2 互換性要件
- **OS**: macOS 12.0以降、Windows 10/11
- **Premiere Pro**: 2022以降のバージョン
- **動画形式**: MP4, MOV, AVI, MKV
- **音声形式**: AAC, MP3, WAV, PCM
- **解像度**: SD(480p)〜4K(2160p)
- **フレームレート**: 23.976〜60fps

### 3.3 品質要件
- **無音検出精度**: 95%以上（誤検出率5%以下）
- **文字起こし精度**: 90%以上（クリアな音声）
- **XML互換性**: Premiere Proでのエラー率0%
- **処理成功率**: 99%以上

### 3.4 セキュリティ要件
- **API キー管理**: 環境変数での安全な管理
- **一時ファイル**: 処理完了後の自動削除
- **ログ**: 個人情報を含まないログ出力

## 4. 技術要件

### 4.1 XML生成の技術仕様

#### 4.1.1 フレームレート処理
- **要件**: 動画のネイティブフレームレートを自動検出
- **実装**:
  ```
  - 29.97fps → NTSC=TRUE, timebase=30
  - 30fps → NTSC=FALSE, timebase=30
  - 23.976fps → NTSC=TRUE, timebase=24
  - 24fps → NTSC=FALSE, timebase=24
  - 25fps → PAL, timebase=25
  ```

#### 4.1.2 pproTicks計算
- **要件**: Premiere Pro固有の時間単位での正確な計算
- **実装**:
  ```
  1秒 = 282,432,000 ticks
  1フレーム = 282,432,000 / フレームレート
  ```

#### 4.1.3 ファイルパス処理
- **要件**: OS別のファイルパス形式への対応
- **実装**:
  - macOS: `file://localhost/Volumes/...`
  - Windows: `file://localhost/C:/...`
  - スペースのエンコーディング: `%20`

### 4.2 アーキテクチャ要件
- **処理パイプライン**: モジュラー設計による拡張性
- **エラーハンドリング**: 各段階での適切なエラー処理
- **ロギング**: 詳細なデバッグログの出力
- **設定**: JSONベースの設定ファイル

## 5. インターフェース要件

### 5.1 CLI（コマンドラインインターフェース）
```bash
# 基本コマンド
python main.py <video_file> [options]

# オプション
--output, -o          : 出力ファイルパス
--preset, -p          : プリセット名
--config, -c          : 設定ファイルパス
--batch               : バッチ処理モード
--dry-run             : 実行せずに処理内容を表示
```

### 5.2 GUI（グラフィカルユーザーインターフェース）
- **フレームワーク**: PyQt5
- **主要画面**:
  - メイン画面: ファイル選択、処理開始
  - 設定画面: パラメータ調整
  - プレビュー画面: 結果確認
  - 進捗画面: 処理状況表示

### 5.3 設定ファイル形式
```json
{
  "silence_detection": {
    "method": "amplitude",
    "threshold_db": -35,
    "min_duration_ms": 1000,
    "margin_ms": 200
  },
  "transcription": {
    "api": "whisper",
    "language": "ja",
    "model": "large-v3"
  },
  "caption": {
    "chars_per_line": 15,
    "max_lines": 2,
    "min_duration_sec": 1.0
  },
  "export": {
    "format": "premiere_xml",
    "version": "4",
    "method": "multiple_clips"
  }
}
```

## 6. 運用要件

### 6.1 導入要件
- インストール手順書の提供
- 初期設定ガイドの作成
- サンプルプロジェクトの提供

### 6.2 保守要件
- 月次アップデートの提供
- バグ修正の迅速な対応
- APIバージョンアップへの追従

### 6.3 サポート要件
- 社内向けマニュアルの整備
- FAQ/トラブルシューティングガイド
- 問い合わせ対応フロー

## 7. 制約事項

### 7.1 技術的制約
- OpenAI APIの利用制限（レート制限）
- 大容量動画ファイルの処理時間
- ローカルストレージの容量

### 7.2 運用上の制約
- APIキーの管理責任
- 処理コストの管理
- ライセンス条件の遵守

## 8. 今後の拡張性

### 8.1 短期的拡張（3-6ヶ月）
- After Effects対応
- DaVinci Resolve対応
- 音楽・効果音の自動検出

### 8.2 中期的拡張（6-12ヶ月）
- リアルタイム処理
- クラウド処理対応
- チーム共有機能

### 8.3 長期的拡張（1年以上）
- AI編集アシスタント機能
- 自動編集提案機能
- マルチ言語対応の拡充

## 9. 成功指標

### 9.1 定量的指標
- 編集時間の削減率: 70%以上
- 処理成功率: 99%以上
- ユーザー満足度: 4.5/5.0以上

### 9.2 定性的指標
- 編集品質の向上
- 編集者のストレス軽減
- 創造的作業への時間配分増加

## 10. リスクと対策

### 10.1 技術的リスク
- **リスク**: API サービスの停止
- **対策**: オフライン処理モードの実装

### 10.2 運用リスク
- **リスク**: 処理コストの増大
- **対策**: 使用量モニタリングとアラート機能

### 10.3 品質リスク
- **リスク**: 誤検出による重要部分のカット
- **対策**: プレビュー機能と手動調整機能の充実

---

作成日: 2024年6月25日
バージョン: 1.0